100 REM			*** PROGRAM PJFRAME ***
105 REM 	AUTHOR:
110 REM				DAVID K. BROWN
112 REM		DEPARTMENT OF MECHANICAL ENGINEERING
115	REM			 UNIVERSITY OF GLASGOW
120 REM 			  SCOTLAND
125	REM		
130 REM				JUNE 1989
135	REM				(VERSION 8/06/89)
140 REM		** THE PROGRAM WILL ANALYSE PLANE
141 REM		   FRAME/TRUSS PROBLEMS WITH UP TO 
142 REM		   40 NODES AND 40 MEMBERS.	  		**
145 REM 	
146 REM 	** LOADING IS APPLIED THROUGH COORDINATE
147 REM		   NODAL FORCES AND 4 TYPES OF DISPLACEMENT
148 REM 	   BOUNDARY CONDITIONS ARE ALLOWED. **
149 REM
150 REM		** DATA INPUT IS FROM THE USER VIA THE KEYBOARD
151 REM		   (IN RESPONSE TO PROMPTS APPEARING ON THE SCREEN). **
153 REM
155 REM     ** OUTPUT IS SEND DIRECT TO THE PRINTER AND CONSISTS OF:
156 REM			NODAL DISPLACEMENTS AND FORCES;
157 REM 		MEMBER FORCES, STRESSES AND ELONGATIONS.   		 **
160 REM
170 REM
220 PN$ = "PJFRAME"
225 GOSUB 50140 : REM CLEARSCREEN
230 MX = 40 : REM MAX # OF MEMBERS
240 NX = 40 : REM MAX # OF NODES
245 NF = 2*NX : REM MAX # OF DEGREES OF FREEDOM
260 DIM NI(MX),NJ(MX),A(MX),E(MX)
270 DIM P(NF),PO(NF+2)
280 DIM X(NX),Y(NX),KODE(NX)
290 DIM KS(NF,NF),KH(NF,NF)
300 DIM PH(NF),F(NF),SP$(NS)
310 IF = 0
320 FOR I = 1 TO NF : PO(I) = 0 : P(I) = 0 : PH(I) = 0 : F(I) = 0 : NEXT I
330 FOR I = 1 TO NF
340 FOR J = 1 TO NF
350 KH(I,J) = 0 : KS(I,J) = 0
360 NEXT J
370 NEXT I
380 IF IR = 1 THEN 600 
390 REM		** DATA IS NOW REQUESTED
400 TM$ = "TOO MANY " : MA$ = " MAXIMUM ALLOWED = "
410 PRINT "HOW MANY MEMBERS IN THE STRUCTURE "; : INPUT NM
420 IF NM > MX THEN PRINT TM$;"MEMBERS,";MA$;MX : GOTO 410
430 PRINT "HOW MANY NODES "; : INPUT NN
440 IF NN > NX THEN PRINT TM$;"NODES,";MA$;NX : GOTO 430
450 PRINT : PRINT
460 PRINT "      NODAL DATA IS REQUIRED" : PRINT
470 PRINT "     NODE NUMBER  "; : INPUT I
480 IF I < 1 OR I > NN THEN PRINT "INVALID NODE NUMBER " : GOTO 470
490 PRINT "TYPE IN KODE (SEE SHEET) "; : INPUT KODE(I)
500 IF KODE(I) < 1 OR KODE(I) > 4 THEN PRINT "INVALID KODE " : GOTO 490
510 PRINT "X,Y COORDS OF NODE";I;"  "; : INPUT X(I),Y(I)
520 PRINT
530 PRINT "APPLIED X,Y FORCES "
540 PRINT "     AT NODE";I;"  ";
550 INPUT PO(2*I-1),PO(2*I) : PRINT
560 PRINT "ANY MORE NODES OR CORRECTIONS [Y/N] ";
570 INPUT AN$ : L1$ = LEFT$(AN$,1)
580 IF L1$ = "Y" OR L1$ = "y" THEN GOTO 470
590 IF L1$ <> "N" AND L1$ <> "n" THEN GOTO 560
600 PRINT "DO YOU WISH A PRINT-OUT OF THE NODAL DATA [Y/N] ";
610 INPUT AN$ : L1$ = LEFT$(AN$,1)
620 IF L1$ = "N" OR L1$ = "n" THEN GOTO 800
630 IF L1$ <> "Y" AND L1$ <> "y" THEN GOTO 600 
640 GOSUB 60120 : REM OPEN PRINTER CHANNEL
650 P$ = "          ****   PROGRAM " + PN$ + "     ****"
660 GOSUB 60000 : IP = 2 : GOSUB 60060
670 P$ = " N KODE    X           Y"
680 P$ = " " + P$
690 P$ = P$ + "          PX          PY" : GOSUB 60000
700 FW = 12 : NS = 3
710 FOR I = 1 TO NN
720 XA = I : GOSUB 30000 : P$ = XA$
730 XA = KODE(I) : GOSUB 30000 : P$ = P$ + XA$
740 XS = X(I) : GOSUB 10040 : P$ = P$ + XS$
750 XS = Y(I) : GOSUB 10040 : P$ = P$ + XS$
760 XS = PO(2*I - 1) : GOSUB 10040 : P$ = P$ + XS$
770 XS = PO(2*I) : GOSUB 10040 : P$ = P$ + XS$ : GOSUB 60000
780 NEXT I
790 GOSUB 60130 : REM CLOSE PRINTER CHANNEL
800 PRINT "DO YOU WISH TO CORRECT THE DATA [Y/N] ";
810 INPUT AN$ : L1$ = LEFT$(AN$,1)
820 IF L1$ = "Y" OR L1$ = "y" THEN GOTO 460
830 IF L1$ <> "N" AND L1$ <> "N" THEN GOTO 800
840 IF IR = 1 THEN GOTO 970
850 N = 2*NN
860 GOSUB 50140
870 PRINT "        MEMBER DATA IS REQUIRED"
880 PRINT : PRINT : PRINT "INPUT THE MEMBER #,& THE I,J OF ITS END NODES";
890 INPUT L, NI(L), NJ(L)
900 IF L < 1 OR L > NM THEN PRINT "INVALID MEMBER NUMBER" : GOTO 880
910 PRINT "INPUT THE AREA AND ELASTIC MODULUS OF THE MEMBER ";
920 INPUT A(L), E(L)
930 PRINT : PRINT "ANY MORE MEMBERS OR CORRECTIONS [Y/N] ";
940 INPUT AN$ : L1$=LEFT$(AN$,1)
950 IF L1$ = "Y" OR L1$ = "y" THEN GOTO 880
960 IF L1$ <> "N" AND L1$ <> "n" THEN GOTO 930 
970 PRINT "DO YOU WISH A PRINT-OUT OF MEMBER DATA [Y/N] ";
980 INPUT AN$ : L1$ = LEFT$(AN$,1)
990 IF L1$ = "N" OR L1$ = "n" THEN GOTO 1120
1000 IF L1$ <> "Y" AND L1$ <> "y" THEN GOTO 970
1010 GOSUB 60120 : REM OPEN PRINTER CHANNEL
1020 GOSUB 60040 
1030 P$ = "  M  NI  NJ  AREA        E" : GOSUB 60000
1040 FOR L = 1 TO NM
1050 XA = L : GOSUB 30000 : P$ = XA$ + " "

